{"title":"一键生成Hexo文章框架","slug":"Software-CreatHexoPost","date":"2017-08-14T14:51:27.000Z","updated":"2017-08-16T08:56:38.059Z","comments":true,"path":"api/articles/Software-CreatHexoPost.json","excerpt":"程序才写完，具体明天写~<br>程序写完了，现在开始因为使用命令行生成文章，然后再往里面添加“分类”和“标签”特别麻烦。。。<br>所以就用C#做了一个小程序。<br>没学过C#，全程靠百度和一点初中学过仅剩的一点点VB经验完成了这个小工具。可把我牛逼坏了~<br>叉会儿腰~<br> [Figure] ","covers":["https://i.loli.net/2017/08/15/5992f583397d9.png","https://i.loli.net/2017/08/15/5992f45fcf048.png"],"content":"<blockquote>\n<p>程序才写完，具体明天写~<br>程序写完了，现在开始</p>\n</blockquote>\n<p>因为使用命令行生成文章，然后再往里面添加“分类”和“标签”特别麻烦。。。<br>所以就用C#做了一个小程序。<br>没学过C#，全程靠百度和一点初中学过仅剩的一点点VB经验完成了这个小工具。可把我牛逼坏了~<br>叉会儿腰~<br><img src=\"https://i.loli.net/2017/08/15/5992f583397d9.png\" alt=\"timg.png\"><br>工具界面就是这么简单~<br><img src=\"https://i.loli.net/2017/08/15/5992f45fa6355.png\" alt=\"creatHexoPost.png\"><br><a id=\"more\"></a><br>“生成路径”就是post所在的_post文件夹；<br>“文件名”和“文章名”顾名思义就好了~<br>“分类”和“标签”的内容需要用全角的“，”，关于半角逗号的兼容，暂时懒得往里加，反正是自己用的东西，将就着用吧。。。<br>“创建时间”可以自动获取，文件创建完成后自动打开文件夹。</p>\n<p>例如，输入内容如下图：<br><img src=\"https://i.loli.net/2017/08/15/5992f45fcf048.png\" alt=\"creatHexoPost2.png\"><br>产生的文件结构就是这样的：<br><img src=\"https://i.loli.net/2017/08/15/5992f45fe9e3d.png\" alt=\"creatHexoPost3.png\"></p>\n<p>主要代码都在这里了：<br><figure class=\"highlight cs\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">string</span> file_name = text_fileName.Text;</div><div class=\"line\"><span class=\"keyword\">string</span> post_name = text_postName.Text;</div><div class=\"line\"><span class=\"keyword\">string</span> categories = text_catName.Text;</div><div class=\"line\"><span class=\"keyword\">string</span> tags = text_tagsName.Text;</div><div class=\"line\"><span class=\"keyword\">string</span> path = filePath.Text;</div><div class=\"line\"><span class=\"comment\">// 创建文件</span></div><div class=\"line\">FileStream fs = <span class=\"keyword\">new</span> FileStream(path + <span class=\"string\">\"/\"</span>+ file_name +<span class=\"string\">\".md\"</span>, FileMode.OpenOrCreate, FileAccess.ReadWrite); </div><div class=\"line\">         </div><div class=\"line\"><span class=\"comment\">// 创建写入流</span></div><div class=\"line\">StreamWriter sw = <span class=\"keyword\">new</span> StreamWriter(fs);</div><div class=\"line\">sw.WriteLine(<span class=\"string\">\"---\"</span>);</div><div class=\"line\">sw.WriteLine(<span class=\"string\">\"title: \"</span> + post_name);</div><div class=\"line\">sw.WriteLine(<span class=\"string\">\"date: \"</span> + DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd \"</span>)+ DateTime.Now.ToLongTimeString().ToString());</div><div class=\"line\">sw.WriteLine(<span class=\"string\">\"categories: \"</span>);</div><div class=\"line\"><span class=\"keyword\">string</span>[] categorie_Arr = categories.Split(<span class=\"string\">'，'</span>);</div><div class=\"line\"><span class=\"keyword\">foreach</span>(<span class=\"keyword\">string</span> c <span class=\"keyword\">in</span> categorie_Arr)&#123;</div><div class=\"line\">\tsw.WriteLine(<span class=\"string\">\"- \"</span> + c);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">sw.WriteLine(<span class=\"string\">\"tags: \"</span>);</div><div class=\"line\"><span class=\"keyword\">string</span>[] tags_Arr = tags.Split(<span class=\"string\">'，'</span>);</div><div class=\"line\"><span class=\"keyword\">foreach</span> (<span class=\"keyword\">string</span> t <span class=\"keyword\">in</span> tags_Arr)&#123;</div><div class=\"line\">\tsw.WriteLine(<span class=\"string\">\"- \"</span> + t);</div><div class=\"line\">&#125;</div><div class=\"line\">sw.WriteLine(<span class=\"string\">\"---\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//关闭文件</span></div><div class=\"line\">sw.Close();</div><div class=\"line\">MessageBox.Show(<span class=\"string\">\"文件生成完毕！\"</span>);</div><div class=\"line\"><span class=\"keyword\">this</span>.Close();</div><div class=\"line\">System.Diagnostics.Process.Start(<span class=\"string\">\"explorer.exe\"</span>, path);</div></pre></td></tr></table></figure></p>\n<p>下载链接：<a href=\"https://drive.google.com/open?id=0B0hyQIP3Ig9rMUVCUFlYZHItaE0\" target=\"_blank\" rel=\"external\">https://drive.google.com/open?id=0B0hyQIP3Ig9rMUVCUFlYZHItaE0</a></p>\n","categories":[{"name":"编程","path":"api/categories/编程.json"},{"name":"C#","path":"api/categories/C#.json"}],"tags":[{"name":"hexo","path":"api/tags/hexo.json"},{"name":"C#","path":"api/tags/C#.json"}]}